<UserControl x:Class="TEdit.View.Sidebar.PlayerEditorView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:p="clr-namespace:TEdit.Properties"
    xmlns:vm="clr-namespace:TEdit.ViewModel"
    xmlns:controls="clr-namespace:TEdit.View.Sidebar.Controls"
    xmlns:pe="clr-namespace:TEdit.View.Sidebar.PlayerEditor"
    mc:Ignorable="d" d:DesignWidth="340"
    DataContext="{Binding Source={x:Static vm:ViewModelLocator.PlayerEditorViewModel}}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="4">

            <!-- Load/Save Toolbar -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                <Button Style="{StaticResource CompactIconButton}" ToolTip="{x:Static p:Language.player_editor_load}"
                        Command="{Binding LoadPlayerCommand}" Margin="0,0,2,0">
                    <ui:SymbolIcon Symbol="FolderOpen20" FontSize="16"/>
                </Button>
                <Button Style="{StaticResource CompactIconButton}" ToolTip="{x:Static p:Language.player_editor_save}"
                        Command="{Binding SavePlayerCommand}" Margin="0,0,2,0">
                    <ui:SymbolIcon Symbol="Save20" FontSize="16"/>
                </Button>
                <Button Style="{StaticResource CompactIconButton}" ToolTip="{x:Static p:Language.player_editor_save_as}"
                        Command="{Binding SavePlayerAsCommand}" Margin="0,0,4,0">
                    <ui:SymbolIcon Symbol="SaveEdit20" FontSize="16"/>
                </Button>
                <TextBlock Text="{Binding PlayerFilePath}" Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                           FontSize="10" VerticalAlignment="Center" TextTrimming="CharacterEllipsis" MaxWidth="200"/>
            </StackPanel>

            <!-- Status bar -->
            <TextBlock Text="{Binding StatusText}" Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                       FontSize="10" Margin="0,0,0,4"/>

            <!-- Player Info (visible when loaded) -->
            <StackPanel Visibility="{Binding Player, Converter={StaticResource NullToVisibilityConverter}, FallbackValue=Collapsed}">

                <!-- Name + Difficulty -->
                <Grid Margin="0,0,0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{x:Static p:Language.player_editor_name}" Foreground="{DynamicResource TextBrush}"
                               FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,4,0"/>
                    <TextBox Grid.Column="1" Text="{Binding Player.Name}" MaxLength="20" Height="26"/>
                    <TextBlock Grid.Column="2" Text="{x:Static p:Language.player_editor_difficulty}"
                               Foreground="{DynamicResource TextBrush}" FontWeight="Bold"
                               VerticalAlignment="Center" Margin="8,0,4,0"/>
                    <ComboBox Grid.Column="3" Width="100" Height="26"
                              SelectedIndex="{Binding Player.Difficulty}">
                        <ComboBoxItem Content="Classic"/>
                        <ComboBoxItem Content="Mediumcore"/>
                        <ComboBoxItem Content="Hardcore"/>
                        <ComboBoxItem Content="Journey"/>
                    </ComboBox>
                </Grid>

                <!-- Hair + Skin Variant -->
                <Grid Margin="0,0,0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="60"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{x:Static p:Language.player_editor_hair}" Foreground="{DynamicResource TextBrush}"
                               FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,4,0"/>
                    <ui:NumberBox Grid.Column="1" Value="{Binding Player.Appearance.Hair}" Minimum="0" Maximum="227"
                                  SpinButtonPlacementMode="Compact" Height="28"/>
                    <TextBlock Grid.Column="2" Text="{x:Static p:Language.player_editor_skin}"
                               Foreground="{DynamicResource TextBrush}" FontWeight="Bold"
                               VerticalAlignment="Center" Margin="8,0,4,0"/>
                    <ui:NumberBox Grid.Column="3" Value="{Binding Player.Appearance.SkinVariant}" Minimum="0" Maximum="11"
                                  SpinButtonPlacementMode="Compact" Height="28"/>
                </Grid>

                <!-- Appearance Colors Expander -->
                <Expander Header="{x:Static p:Language.player_editor_appearance_colors}" IsExpanded="False" Margin="0,0,0,4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Hair Color -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,2">
                            <TextBlock Text="{x:Static p:Language.player_editor_hair_color}" Foreground="{DynamicResource TextBrush}" FontSize="11" FontWeight="SemiBold"/>
                            <controls:HslColorPickerControl DataContext="{Binding HairColorVm}"/>
                        </StackPanel>

                        <!-- Skin Color -->
                        <StackPanel Grid.Row="0" Grid.Column="1" Margin="4,2,0,2">
                            <TextBlock Text="{x:Static p:Language.player_editor_skin_color}" Foreground="{DynamicResource TextBrush}" FontSize="11" FontWeight="SemiBold"/>
                            <controls:HslColorPickerControl DataContext="{Binding SkinColorVm}"/>
                        </StackPanel>

                        <!-- Eye Color -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,2">
                            <TextBlock Text="{x:Static p:Language.player_editor_eye_color}" Foreground="{DynamicResource TextBrush}" FontSize="11" FontWeight="SemiBold"/>
                            <controls:HslColorPickerControl DataContext="{Binding EyeColorVm}"/>
                        </StackPanel>

                        <!-- Shirt Color -->
                        <StackPanel Grid.Row="1" Grid.Column="1" Margin="4,2,0,2">
                            <TextBlock Text="{x:Static p:Language.player_editor_shirt_color}" Foreground="{DynamicResource TextBrush}" FontSize="11" FontWeight="SemiBold"/>
                            <controls:HslColorPickerControl DataContext="{Binding ShirtColorVm}"/>
                        </StackPanel>

                        <!-- Undershirt Color -->
                        <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,2">
                            <TextBlock Text="{x:Static p:Language.player_editor_undershirt_color}" Foreground="{DynamicResource TextBrush}" FontSize="11" FontWeight="SemiBold"/>
                            <controls:HslColorPickerControl DataContext="{Binding UnderShirtColorVm}"/>
                        </StackPanel>

                        <!-- Pants Color -->
                        <StackPanel Grid.Row="2" Grid.Column="1" Margin="4,2,0,2">
                            <TextBlock Text="{x:Static p:Language.player_editor_pants_color}" Foreground="{DynamicResource TextBrush}" FontSize="11" FontWeight="SemiBold"/>
                            <controls:HslColorPickerControl DataContext="{Binding PantsColorVm}"/>
                        </StackPanel>

                        <!-- Shoe Color -->
                        <StackPanel Grid.Row="3" Grid.Column="0" Margin="0,2">
                            <TextBlock Text="{x:Static p:Language.player_editor_shoe_color}" Foreground="{DynamicResource TextBrush}" FontSize="11" FontWeight="SemiBold"/>
                            <controls:HslColorPickerControl DataContext="{Binding ShoeColorVm}"/>
                        </StackPanel>
                    </Grid>
                </Expander>

                <!-- Sub-section tabs -->
                <TabControl SelectedIndex="{Binding SelectedSubTabIndex}" Margin="0,2,0,0">
                    <TabItem Header="{x:Static p:Language.player_editor_equipment}">
                        <pe:PlayerEquipmentView/>
                    </TabItem>
                    <TabItem Header="{x:Static p:Language.player_editor_inventory}">
                        <pe:PlayerInventoryView/>
                    </TabItem>
                    <TabItem Header="{x:Static p:Language.player_editor_banks}">
                        <pe:PlayerBanksView/>
                    </TabItem>
                    <TabItem Header="{x:Static p:Language.player_editor_buffs}">
                        <pe:PlayerBuffsView/>
                    </TabItem>
                    <TabItem Header="{x:Static p:Language.player_editor_stats}">
                        <pe:PlayerStatsView/>
                    </TabItem>
                    <TabItem Header="{x:Static p:Language.player_editor_journey}">
                        <pe:PlayerJourneyView/>
                    </TabItem>
                </TabControl>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</UserControl>
